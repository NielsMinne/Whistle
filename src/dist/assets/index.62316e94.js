import{N as X,i as K,g as $,a as B,L as w,U as C,K as f,V as u,w as _,D as m,h as I,y as v,S as T,b,T as P,p as U,Q as z,r as D,u as O,c as j,E as Q,d as Z,e as A,f as ee,j as te,s as ae,G as ne,k as se,o as re,l as W,m as J,n as ie}from"./vendor.984efbf6.js";const oe=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const o of r.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function a(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerpolicy&&(r.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?r.credentials="include":s.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function n(s){if(s.ep)return;s.ep=!0;const r=a(s);fetch(s.href,r)}};oe();const ce="nielsminne@gmail.com",le=14,de=22,me=["ableism","ageism","alloism","anti-Blackness","antisemitism","biphobia","catcalling","classism","enbyphobia","ethnocentrism","eugenics","fatphobia","homophobia","islamophobia","lesbophobia","misogynoir","misogyny","nativism","queerphobia","racism","religious imperialism","sexism","sizeism","stigmatization of addiction","stigmatization of homelessness","toxic masculinity","transphobia","whorephobia"],c=i=>document.querySelector(i),d=new X("/"),he={apiKey:"AIzaSyCq0mbdeUTCQXY3TO8YySzTQoysILTJBIc",authDomain:"whistle-c6850.firebaseapp.com",projectId:"whistle-c6850",storageBucket:"whistle-c6850.appspot.com",messagingSenderId:"598540406228",appId:"1:598540406228:web:17c05d2920bee1dae15a41"},G=()=>{K(he)};class pe{constructor(){this.allUsers=[],this.friends=[],this.acceptedUsers=[],this.friendRequests=[],G(),this.auth=$(),this.storage=B(),this.firestore=w()}async getAllUsers(){const t=C(u(this.firestore,"Users"),f("uid","!=",this.uid)),a=await _(t),n=[];a.forEach(s=>{s.exists()?n.push(s.data()):console.log("damn")}),this.allUsers=n}async getAllFriends(){const t=m(this.firestore,"Users",this.uid),a=await I(t);a.exists()?this.friends=a.data().friends:console.log("no friends");const n=C(u(this.firestore,"Users"),f("friendRequests","array-contains",this.uid)),s=await _(n),r=[];s.forEach(o=>{o.exists()&&r.push(o.data().uid)}),this.friendRequests=r}}class N extends pe{constructor(t,a,n,s,r,o,l,h){super();this.email=t,this.username=a,this.firstName=n,this.lastName=s,this.phoneNumber=r,this.uid=o,this.avatar=l,this.password=h}async addFriends(){await this.setUserInfo(),document.querySelectorAll(".add-people input:checked").forEach(async a=>{await v(m(this.firestore,"Users",JSON.parse(localStorage.getItem("user")).uid),{friendRequests:T(a.id)})})}async showFriendRequest(t){const a=C(u(this.firestore,"Users"),f("friendRequests","array-contains",this.uid));(await _(a)).forEach(s=>{const r=c(".friends-container__invitation-container");s.exists()&&r.appendChild(e.createInviteButton({textContent:`${s.data().username} <i class='fas fa-chevron-circle-right fa-lg'></i>`,classname:"invitation__button",eventUID:s.data().uid,onClick:async()=>{c(".friend-list-container").innerHTML="";const o=c(".friend-list-container");console.log(o),e.createFriendRequestOverlay({container:o,doc:s.data(),acceptOnClick:async()=>{await this.acceptFriendRequest(s.data().uid,this.uid).then(()=>{t.clearComponentContainer(),t.renderAsync()})},rejectOnClick:()=>{this.rejectFriendRequest(s.data().uid),t.clearComponentContainer(),t.renderAsync()}})}}))})}async acceptFriendRequest(t,a){const n=m(this.firestore,"Users",t);await v(n,{friends:T(this.uid),friendRequests:b(this.uid)});const s=m(this.firestore,"Users",a);await v(s,{friends:T(t),friendRequests:b(t)});const r=await P(u(this.firestore,"Chatrooms"),{usersUID:[t,a]});await v(m(this.firestore,"Chatrooms",r.id),{chatroomUID:r.id})}async rejectFriendRequest(t){const a=m(this.firestore,"Users",t);await v(a,{friendRequests:b(this.uid)})}async removeFriend(t,a){await v(m(this.firestore,"Users",a),{friends:b(t)}),await v(m(this.firestore,"Users",t),{friends:b(a)});const n=C(u(this.firestore,"Chatrooms"),f("usersUID","array-contains",t));(await _(n)).forEach(async r=>{if(r.data().usersUID.includes(a)){const o=m(this.firestore,"Chatrooms",r.data().chatroomUID);await U(o)}})}async getSpecificFriend(t){const a=m(this.firestore,"Users",t),n=await I(a);n.exists()&&localStorage.setItem("friend",JSON.stringify(n.data()))}async showFriends(t){this.friends.forEach(async a=>{const n=C(u(this.firestore,"Users"),f("uid","==",a),z("username"));(await _(n)).forEach(r=>{const o=c(".friends-container");r.exists()?o.appendChild(e.createFriendCard({url:r.data().avatarImageUrl,username:r.data().username,deleteID:r.data().uid,onClick:()=>{e.createFriendDeleteOverlay({container:c(".friend-list-container"),doc:r.data(),componentContainer:t})}})):console.log("no data")})})}async setUserInfo(){const t=m(this.firestore,"Users",JSON.parse(localStorage.getItem("user")).uid),a=await I(t);if(a.exists()){this.email=a.data().email,this.username=a.data().username,this.firstName=a.data().firstName,this.lastName=a.data().lastName,this.phoneNumber=a.data().phoneNumber,this.uid=JSON.parse(localStorage.getItem("user")).uid,this.avatar=a.data().avatarImageUrl;const n=`${this.firstName} ${this.lastName}`,{email:s}=this;localStorage.setItem("fullName",n),localStorage.setItem("email",s)}}async checkIfFriends(){const t=C(u(this.firestore,"Users"),f("Friends","==",!0));return!!(await I(t)).exists()}async uploadAvatar(t){const a=D(this.storage,`userAvatar/avatar-${JSON.parse(localStorage.getItem("user")).uid}`),n=D(this.storage,`userAvatar/avatar-${JSON.parse(localStorage.getItem("user")).uid}`);await O(a,t).then(s=>{}).then(()=>{j(D(this.storage,n)).then(s=>{this.updateUserImage(s)})})}async getAvatar(){const t=m(this.firestore,"Users",JSON.parse(localStorage.getItem("user")).uid),a=await I(t);a.exists()&&localStorage.setItem("avatarImageUrl",a.data().avatarImageUrl)}async updateUserImage(t){await v(m(this.firestore,"Users",JSON.parse(localStorage.getItem("user")).uid),{avatarImageUrl:t})}async updateUserInfo(t,a,n,s){await v(m(this.firestore,"Users",JSON.parse(localStorage.getItem("user")).uid),{username:t,firstName:a,lastName:n,phoneNumber:s})}getCreationDate(){const t=new Date,a={day:"numeric",month:"short",year:"numeric"};return t.toLocaleDateString("be-NL",a)}async getAccountData(){const t=new FormData(c("form:nth-child(1)"));this.email=t.get("email"),this.password=t.get("password"),console.log(this.email)}async deleteAllUserData(t){t.forEach(async h=>{await this.removeFriend(h,this.uid)}),await U(m(this.firestore,"Users",this.uid));const a=C(u(this.firestore,"Events"),f("hostUID","==",this.uid));(await _(a)).forEach(async h=>{h.exists()&&await U(m(this.firestore,"Events",h.id))});const s=C(u(this.firestore,"Events"),f("acceptedUsers","array-contains",this.uid));(await _(s)).forEach(async h=>{h.exists()&&await v(m(this.firestore,"Events",h.id),{acceptedUsers:b(this.uid)})});const o=C(u(this.firestore,"Events"),f("invitedUsers","array-contains",this.uid));(await _(o)).forEach(async h=>{h.exists()&&await v(m(this.firestore,"Events",h.id),{acceptedUsers:b(this.uid)})})}async deleteAccount(){await this.getAccountData(),await this.getAllFriends();const t=Q.credential(this.email,this.password);Z(this.auth.currentUser,t).then(async()=>{await this.deleteAllUserData(this.friends),await this.auth.currentUser.delete().then(()=>{d.navigate("/")})}).catch(a=>{console.log(a)})}}class x{constructor(t,a,n,s){this.street=t,this.number=a,this.city=n,this.coords=s,this.takeCareUserInfo=[],this.user=new N,this.firestore=w()}async checkLocation(){const t=c("#location").value,a=await this.fetchLocation(t),n=c("#mapContainer");n.innerHTML="",mapboxgl.accessToken="pk.eyJ1IjoibmllbHNtaSIsImEiOiJja255YXJwZGIwNTFsMnhyanUzc2xpM3lwIn0.0gILckTI2ATyJCc7fOs3Eg";const s=new mapboxgl.Map({container:n,style:"mapbox://styles/mapbox/streets-v11",center:[a[0].lon,a[0].lat],zoom:14}),r=document.createElement("div");r.style.width="40px",r.style.height="40px",r.className="marker",new mapboxgl.Marker(r).setLngLat([a[0].lon,a[0].lat]).addTo(s)}async fetchLocation(t){const n=await(await fetch(`https://nominatim.openstreetmap.org/search.php?q=${t}&format=jsonv2`)).json();if(n.error)throw new Error(n.error);return n}async fetchAdressByCoords(t){const n=await(await fetch(`https://nominatim.openstreetmap.org/reverse.php?lat=${t[1]}&lon=${t[0]}&zoom=18&format=jsonv2`)).json();if(n.error)throw new Error(n.error);return n}async setLocationData(){const t=c("#location").value,a=await this.fetchLocation(t),n=a.filter(s=>s.category==="building")[0].display_name.split(",");this.coords=[a.filter(s=>s.category==="building")[0].lon,a.filter(s=>s.category==="building")[0].lat],[this.number,this.street,,,this.city]=n}async autoAdressFill(t){const n=(await this.fetchAdressByCoords(t)).display_name.split(",");return[this.number,this.street,,,this.city]=n,`${this.street}, ${this.number}, ${this.city}`}async setEventLocationData({street:t,city:a,number:n,coords:s}){this.street=t,this.city=a,this.number=n,this.coords=s}async calculateDistanceBetweenPoints(t,a){const n=6371,s=(a[1]-t[1])*(Math.PI/180),r=(a[0]-t[0])*(Math.PI/180),o=Math.sin(s/2)*Math.sin(s/2)+Math.cos(t[1]*(Math.PI/180))*Math.cos(a[1]*(Math.PI/180))*Math.sin(r/2)*Math.sin(r/2),l=2*Math.atan(Math.sqrt(o),Math.sqrt(1-o)),h=n*l;return Math.round(h*100)/100}async listenForPositionChanges(){setInterval(async()=>{await this.updatePositionUsers()},1e4)}async getUsersCoords(){const t=C(u(this.firestore,"Events",localStorage.getItem("activeEventUID"),"Positions")),a=await _(t),n=[];a.forEach(s=>{s.exists()&&n.push(s.data().userInfo)}),this.takeCareUserInfo=n}async checkIfInEventRadius(t,a){await this.calculateDistanceBetweenPoints(localStorage.getItem("currentPositionCoords").split(","),t)<=.1&&(clearInterval(a),d.navigate("/home"),localStorage.removeItem("activeEventUID"))}async updatePositionUsers(){await this.user.setUserInfo(),this.getCurrentPosition();const t=m(this.firestore,`Events/${localStorage.getItem("activeEventUID")}/Positions`,this.user.uid);await A(t,{userUID:this.user.uid,userInfo:[localStorage.getItem("currentPositionCoords"),this.user.avatar,this.user.username]})}async getCurrentPosition(){const t={enableHighAccuracy:!0};navigator.geolocation.getCurrentPosition(this.succes,this.error,t)}async succes(t){const a=[t.coords.longitude,t.coords.latitude];localStorage.setItem("currentPositionCoords",a)}async error(t){console.log(t)}}class H{constructor(){this.audio=new Audio}playMessage(){this.audio=new Audio("../assets/other/sounds/chat_message.mp3"),this.audio.play(),this.audio.volume=.2}playEventActive(){this.audio=new Audio("../assets/other/sounds/event_active.mp3"),this.audio.play(),this.audio.volume=.4}playPanicPopup(){this.audio=new Audio("../assets/other/sounds/panic_sound.mp3"),this.audio.play(),this.audio.volume=.4}playLoginAccepted(){this.audio=new Audio("../assets/other/sounds/login_accepted.mp3"),this.audio.play(),this.audio.volume=.3}}class k{constructor(t,a,n){this.email=t,this.username=a,this.password=n,this.auth=$(),this.audio=new H,this.firestore=w()}async register(){this.setData(),await ee(this.auth,this.email,this.password).then(()=>{te(this.auth.currentUser,{displayName:this.username})}).then(()=>{d.navigate("/info")}).catch(t=>{c(".error-message").innerHTML=t.code.split("/")[1].replace("-"," ")})}async login(){const t=new FormData(c("form"));this.email=t.get("email"),this.password=t.get("password"),await ae(this.auth,this.email,this.password).then(()=>{this.audio.playLoginAccepted(),d.navigate("/home")}).catch(a=>{c(".error-message").innerHTML=a.code.split("/")[1].replace("-"," ")})}async loginWithGoogle(){const t=new ne;try{await se(this.auth,t).then(async()=>{const a=m(this.firestore,"Users",this.auth.currentUser.uid);(await I(a)).exists()?(this.audio.playLoginAccepted(),d.navigate("/home")):(this.updateGoogleData(),this.audio.playLoginAccepted(),d.navigate("/home"))})}catch(a){c(".error-message").innerHTML=a.message}}async addUserToDatabase(t="",a="",n="",s="",r="",o="",l=""){await A(m(this.firestore,"Users",this.auth.currentUser.uid),{firstName:t,lastName:a,phoneNumber:n,email:s,username:r,uid:o,avatarImageUrl:l,friends:[]})}async addGoogleUserToDatabase(t="",a="",n="",s="",r="",o="",l=""){await A(m(this.firestore,"Users",this.auth.currentUser.uid),{firstName:t,lastName:a,phoneNumber:n,email:s,username:r,uid:o,avatarImageUrl:l,friends:[]})}setData(){const t=new FormData(c("form"));this.email=t.get("email"),this.username=t.get("username"),this.password=t.get("password")}async updateData(){const t=new FormData(c("form")),a=t.get("firstName"),n=t.get("lastName"),s=t.get("phoneNumber");await this.addUserToDatabase(a,n,s,this.auth.currentUser.email,this.auth.currentUser.displayName,this.auth.currentUser.uid,"../assets/avatars/Whistle.png")}async updateGoogleData(){const t=this.auth.currentUser.displayName.split(" ")[0],a=this.auth.currentUser.displayName.split(" ")[1];await this.addGoogleUserToDatabase(t,a,"",this.auth.currentUser.email,t,this.auth.currentUser.uid,"../assets/avatars/Whistle.png")}async logout(){this.auth.signOut(),localStorage.clear(),window.location.replace("/")}checkifLoggedIn(){re(this.auth,async t=>t?(localStorage.setItem("user",JSON.stringify(t)),t):(d.navigate("/"),null))}}const e={user:new N,location:new x,authenticator:new k,createContainer({className:i="",id:t="",innerHTML:a="",children:n=[],onClick:s=null}){const r=document.createElement("div");return t&&r.setAttribute("id",t),r.className=i,r.innerHTML=a,s&&r.addEventListener("click",()=>{s()}),n.length&&n.forEach(o=>{o instanceof Element&&r.appendChild(o)}),r},createHeader({size:i=1,textContent:t="",className:a="",onClick:n=null}){if(i<1||i>6)return null;const s=document.createElement(`h${i}`);return s.className=a,s.innerHTML=t,n&&s.addEventListener("click",r=>{r.preventDefault(),n()}),s},createAppName({size:i=1}){if(i<1||i>6)return null;const t=document.createElement(`h${i}`);t.className="app-name";const a=document.createElement("span");return a.textContent="!",t.innerHTML="WH<span>!</span>STLE",t},createText({textContent:i="",className:t="",onClick:a=null}){const n=document.createElement("p");return n.innerHTML=i,n.className=t,a&&n.addEventListener("click",s=>{s.preventDefault(),a()}),n},createSmall({textContent:i="",className:t=""}){const a=document.createElement("small");return a.innerHTML=i,a.className=t,a},createButton({textContent:i="",className:t="",onClick:a=null}){const n=document.createElement("button");return n.innerHTML=i,n.className=t,a&&n.addEventListener("click",s=>{s.preventDefault(),a()}),n},createPopupChatButton({textContent:i="",className:t="",onClick:a=null}){const n=document.createElement("button");return n.innerHTML=i,n.className=t,a&&n.addEventListener("click",s=>{s.preventDefault(),localStorage.setItem("chatroomID",s.currentTarget.firstChild.innerHTML),a()}),n},createIcon({className:i="",id:t="",onClick:a=null}){const n=document.createElement("i");return n.className=i,n.id=t,a&&n.addEventListener("click",s=>{s.preventDefault(),localStorage.setItem("deleteFriendUID",s.currentTarget.id),a()}),n},createLink({href:i="#",textContent:t="",target:a="_self"}){const n=document.createElement("a");return n.href=i,n.textContent=t,n.target=a,n},createInput({className:i="",type:t="",id:a="",placeholder:n="",value:s="",required:r=!0,disabled:o=!1,onClick:l=null,maxChar:h}){const p=document.createElement("input");return p.className=i,p.type=t,p.name=a,p.id=a,p.placeholder=n,p.required=r,p.disabled=o,p.value=s,p.max=h,onclick&&p.addEventListener("click",()=>{l()}),p},createLabel({textContent:i="",className:t="",labelFor:a=""}){const n=document.createElement("label");return n.className=t,n.for=a,n.innerHTML=i,n},createCategoryList({categories:i=[],className:t="",placeholder:a=""}){const n=document.createElement("select");return n.name=t,i.forEach(s=>{const r=document.createElement("option");r.value=s,r.innerHTML=s,n.appendChild(r)}),n.className=t,n.placeholder=a,n},createForm({content:i=[],className:t=""}){const a=document.createElement("form");a.className=t;const n=document.createElement("div");return n.className="form",i.forEach(({textContent:s,placeholder:r,type:o,id:l,labelClassName:h,inputClassName:p})=>{const y=document.createElement("div");y.appendChild(e.createInput({className:p,type:o,id:l,placeholder:r})),y.appendChild(e.createLabel({className:h,labelFor:l,textContent:s})),n.appendChild(y)}),a.appendChild(n),a},createMap({coords:i=[],zoom:t=14}){const a=document.createElement("div");a.className="map-container",mapboxgl.accessToken="pk.eyJ1IjoibmllbHNtaSIsImEiOiJja255YXJwZGIwNTFsMnhyanUzc2xpM3lwIn0.0gILckTI2ATyJCc7fOs3Eg";const n=new mapboxgl.Map({container:a,style:"mapbox://styles/mapbox/streets-v11",center:[i[0],i[1]],zoom:t}),s=document.createElement("div");return s.style.width="40px",s.style.height="40px",s.className="marker",new mapboxgl.Marker(s).setLngLat([i[0],i[1]]).addTo(n),a},createTakeCareMap({eventCoords:i=[],coords:t=[],zoom:a=14,usersInfo:n=[]}){const s=document.createElement("div");s.className="map-container",mapboxgl.accessToken="pk.eyJ1IjoibmllbHNtaSIsImEiOiJja255YXJwZGIwNTFsMnhyanUzc2xpM3lwIn0.0gILckTI2ATyJCc7fOs3Eg";const r=new mapboxgl.Map({container:s,style:"mapbox://styles/mapbox/streets-v11",center:[t[0],t[1]],zoom:a}),o=document.createElement("div");return o.style.width="40px",o.style.height="40px",o.className="marker",o.appendChild(e.createContainer({className:"marker__radius"})),new mapboxgl.Marker(o).setLngLat([i[0],i[1]]).addTo(r),n.forEach(l=>{const h=l[0].split(","),p=document.createElement("div");p.style.width="40px",p.style.height="40px",p.className="users-marker",p.style.backgroundImage=`url(${l[1]})`,p.appendChild(e.createText({textContent:l[2]})),new mapboxgl.Marker(p).setLngLat(h).addTo(r)}),s},createImageDiv({className:i="",url:t=""}){const a=document.createElement("div");return a.className=i,a.style.backgroundImage=`url(${t})`,a},createSpan({className:i="",textContent:t=""}){const a=document.createElement("span");return a.className=i,a.innerHTML=t,a},createFriendRequestOverlay({container:i,doc:t,acceptOnClick:a=null,rejectOnClick:n=null}){i.appendChild(e.createContainer({className:"friend-request-overlay",children:[e.createUserAvatar({radius:"100px",url:t.avatarImageUrl,className:"friend-request-overlay__avatar"}),e.createHeader({className:"friend-request-overlay__header",size:4,textContent:`${t.username}<br> wants to add you!`}),e.createContainer({className:"friend-request-overlay__button-container",children:[e.createButton({textContent:"REJECT",className:"button__reject",onClick:()=>{n()}}),e.createButton({textContent:"ACCEPT",className:"button__accept",onClick:()=>{a()}})]})]}))},createFriendDeleteOverlay({container:i,doc:t,componentContainer:a}){i.appendChild(e.createContainer({className:"friend-request-overlay",children:[e.createUserAvatar({radius:"100px",url:t.avatarImageUrl,className:"friend-request-overlay__avatar"}),e.createHeader({className:"friend-request-overlay__header",size:4,textContent:`Are you sure you want <br> to <span>DELETE</span> ${t.username}?`}),e.createContainer({className:"friend-request-overlay__button-container",children:[e.createButton({textContent:"No",className:"button__accept",onClick:()=>{c(".friend-request-overlay").remove()}}),e.createButton({textContent:"Yes",className:"button__reject",onClick:()=>{this.user.removeFriend(localStorage.getItem("deleteFriendUID"),JSON.parse(localStorage.getItem("user")).uid),a.clearComponentContainer(),a.renderAsync()}})]})]}))},createEventCard({url:i="",eventTime:t="",eventName:a="",eventDate:n="",eventUID:s="",onClick:r=null}){const o=document.createElement("div");o.className="event";const l=document.createElement("div");return l.className="event__card",r&&l.addEventListener("click",h=>{h.preventDefault();const p=h.currentTarget.firstChild.innerHTML;localStorage.setItem("hostedEventUID",p),r()}),l.appendChild(e.createText({className:"event__uid",textContent:s})),l.appendChild(e.createSpan({className:"event__date",textContent:n})),l.appendChild(e.createImageDiv({className:"event__image",url:i})),l.appendChild(e.createContainer({children:[e.createHeader({size:4,textContent:t,className:"event__time"}),e.createHeader({size:5,textContent:a,className:"event__name"}),e.createSpan({className:"event__info",textContent:"more info"})]})),o.appendChild(l),o},createParticipant({className:i="",url:t="",username:a=""}){const n=document.createElement("div");return n.className=i,n.appendChild(e.createImageDiv({url:t,className:"user__image"})),n.appendChild(e.createHeader({size:5,textContent:a,className:"user__name"})),n},createInviteButton({textContent:i="",className:t="",onClick:a=null,eventUID:n=" "}){const s=document.createElement("button");return s.innerHTML=i,s.className=t,s.appendChild(e.createText({textContent:n})),a&&s.addEventListener("click",r=>{r.preventDefault();const o=r.currentTarget.lastChild.innerHTML;console.log(o),localStorage.setItem("invitedEvent",o),a()}),s},createFriendCard({className:i="",username:t="",url:a="",deleteID:n="",onClick:s=null}){const r=document.createElement("div");return r.className=i,r.appendChild(e.createContainer({className:"friend-container__friend-card",children:[e.createUserAvatar({url:a,radius:"40px",className:"friend-container__avatar"}),e.createHeader({size:5,className:"friend-container__name",textContent:t}),e.createIcon({className:"fas fa-trash-alt fa-lg friend-container__delete",id:n,onClick:()=>{s()}})]})),r},createChatroomCard({className:i="",username:t="",url:a="",onClick:n=null,eventUID:s=""}){const r=document.createElement("div");return r.className=i,n&&r.addEventListener("click",o=>{o.preventDefault(),localStorage.setItem("chatroomID",o.currentTarget.firstChild.firstChild.innerHTML),n()}),r.appendChild(e.createContainer({className:"chatroom-container__chatroom-card",children:[e.createText({textContent:s,className:"chatroom-container__eventUID no-display"}),e.createUserAvatar({url:a,radius:"40px",className:"chatroom-container__avatar"}),e.createHeader({size:5,className:"chatroom-container__name",textContent:t})]})),r},createLoginForm({content:i=[],className:t="",buttonName:a="",onClick:n=null}){const s=document.createElement("form");s.className=t;const r=document.createElement("div");return r.className="form",i.forEach(({textContent:o,placeholder:l,type:h,id:p,labelClassName:y,inputClassName:L,usernameMaxChar:S})=>{const q=document.createElement("div");q.appendChild(e.createInput({className:L,type:h,id:p,placeholder:l,usernameMaxChar:S})),q.appendChild(e.createLabel({className:y,labelFor:p,textContent:o})),r.appendChild(q)}),r.appendChild(e.createButton({textContent:a,className:"button__login",onClick:()=>{n()}})),s.appendChild(r),s},createFormWithNormalLabel({content:i=[],className:t=""}){const a=document.createElement("form");a.className=t;const n=document.createElement("div");return n.className="form",i.forEach(({textContent:s,placeholder:r,type:o,id:l,inputClassName:h,labelClassName:p,disabled:y,onClick:L})=>{const S=document.createElement("div");S.appendChild(e.createLabel({className:p,labelFor:l,textContent:s})),S.appendChild(e.createInput({className:h,type:o,name:l,id:l,placeholder:r,disabled:y})),L&&S.addEventListener("click",()=>{L()}),n.appendChild(S)}),a.appendChild(n),a},createStartupAnimation(){const i=document.createElement("div"),t=document.createElement("img"),a=document.createElement("h1");return i.className="animation",t.src="./assets/other/Logo.svg",t.className="animation__logo",a.innerHTML='Wh<span class="animation_span">!</span>stle',a.className="animation__name",i.appendChild(t),i.appendChild(a),i},createHomeItem({textContent:i="",className:t="",iconClass:a="",onClick:n=null}){const s=document.createElement("div"),r=document.createElement("h5"),o=document.createElement("i");return r.innerHTML=i,o.className=a,s.className=t,s.appendChild(r),s.appendChild(o),n&&s.addEventListener("click",()=>{n()}),s},createUserAvatar({url:i="",radius:t="",className:a="",username:n="",onClick:s=null}){const r=document.createElement("div");if(s&&r.addEventListener("click",o=>{o.preventDefault(),s()}),i)r.style.backgroundImage=`url(${i})`;else{const o=document.createElement("p");o.innerText=n.charAt(0),r.appendChild(o)}return r.className=a,r.style.width=t,r.style.height=t,r},createHorizontalRule({size:i="",className:t=""}){const a=document.createElement("hr");return a.className=t,a.style.borderTop=`${i}px solid white`,a},createHeaderNav({containerClassName:i="",title:t="",subTitle:a=""}){this.user.getAvatar();const n=document.createElement("div");return n.className=i,n.appendChild(this.createLeftOverlay({overlayClassName:"overlay-left-container hide"})),n.appendChild(this.createRightOverlay({overlayClassName:"overlay-right-container hide"})),n.appendChild(e.createContainer({className:"header-nav",id:"headerNav",children:[e.createIcon({className:"fas fa-bars fa-2x",onClick:()=>{const s=c(".overlay-left-container");s.style.animation="openMenu .7s ease-in-out",s.style.transform="translateX(0px)";const r=c(".overlay-right-container");s.className==="overlay-left-container"?(s.style.animation="closeMenu .5s ease-in",s.style.transform="translateX(-230px)",setTimeout(()=>{s.className="overlay-left-container hide"},500)):(s.className="overlay-left-container",r.style.animation="closeRightMenu .5s ease-in",setTimeout(()=>{r.className="overlay-right-container hide"},500))}}),e.createContainer({className:"header-nav__textcontainer",children:[e.createHeader({size:5,textContent:t,className:"header-nav__maintext"}),e.createText({textContent:a,className:"header-nav__subtext"})]}),e.createUserAvatar({url:localStorage.getItem("avatarImageUrl"),radius:"50px",className:"header-nav__avatar",onClick:()=>{const s=c(".overlay-left-container"),r=c(".overlay-right-container");r.style.animation="openRightMenu .7s ease-in-out",r.style.transform="translateX(0px)",r.className==="overlay-right-container"?(r.style.animation="closeRightMenu .5s ease-in",setTimeout(()=>{r.className="overlay-right-container hide"},500)):(r.className="overlay-right-container",s.style.animation="closeMenu .5s ease-in",s.style.transform="translateX(-230px)",setTimeout(()=>{s.className="overlay-left-container hide"},500))}})]})),n},createAvatarRadioButton({avatarArray:i=[],size:t="",className:a=""}){const n=document.createElement("div");return n.className=a,i.forEach(s=>{const r=document.createElement("div"),o=document.createElement("div");o.style.width=t,o.style.height=t,o.className=`avatar__image-${s}`;const l=document.createElement("input");l.type="radio",l.name="avatarImage",l.style.width=t,l.style.height=t,l.value=`../assets/avatars/${s}.png`,r.appendChild(l),r.appendChild(o),n.appendChild(r)}),n},createLeftOverlay({overlayClassName:i=""}){const t=document.createElement("div");return t.className=i,t.appendChild(e.createContainer({children:[e.createHeader({size:5,textContent:"Home",onClick:()=>{d.navigate("/home")}}),e.createHeader({size:5,textContent:"Create Event",onClick:()=>{d.navigate("/create-event")}}),e.createHeader({size:5,textContent:"My Events",onClick:()=>{d.navigate("/my-events")}}),e.createHeader({size:5,textContent:"Friend List",onClick:()=>{d.navigate("/friend-list")}}),e.createHeader({size:5,textContent:"Chatrooms",onClick:()=>{d.navigate("/chatlist")}}),e.createHeader({size:5,textContent:"Meldet.org",onClick:()=>{d.navigate("/meldet")}})]})),t},createRightOverlay({overlayClassName:i=""}){const t=document.createElement("div");return t.className=i,t.appendChild(e.createContainer({children:[e.createContainer({className:"overlay-right-container__account",children:[e.createUserAvatar({url:localStorage.getItem("avatarImageUrl"),radius:"100px",className:"header-nav__avatar"}),e.createText({textContent:localStorage.getItem("fullName")}),e.createSmall({textContent:localStorage.getItem("email")})]}),e.createContainer({className:"overlay-right-container__items",children:[e.createText({textContent:"Change avatar",onClick:()=>{d.navigate("/account-settings")}}),e.createText({textContent:"Change username",onClick:()=>{d.navigate("/account-settings")}}),e.createText({textContent:"Remove account",className:"overlay-right-container__items--remove-account",onClick:()=>{d.navigate("/account-settings")}}),e.createText({textContent:"Logout",onClick:()=>{localStorage.removeItem("user"),this.authenticator.logout()}})]})]})),t},createAddPeople({avatarUrl:i="",username:t="",uid:a=""}){const n=document.createElement("div");n.className="add-people",n.addEventListener("click",r=>{r.preventDefault(),r.currentTarget.children[2].firstChild.checked?r.currentTarget.children[2].firstChild.checked=!1:r.currentTarget.children[2].firstChild.checked=!0}),n.appendChild(e.createUserAvatar({url:i,radius:"50px",className:"add-people__image"})),n.appendChild(e.createHeader({size:5,textContent:t}));const s=document.createElement("label");return n.appendChild(e.createContainer({children:[e.createInput({className:"add-people__input",type:"radio",id:a,required:!1}),s]})),n}};class g{constructor({name:t,model:a,routerPath:n}){this.name=t,this.model=a,this.routerPath=n,this.componentContainer=this.createComponentContainer(),this.authenticator=new k}createComponentContainer(){return e.createContainer({className:`${this.name}-container container-wrapper`})}clearComponentContainer(){for(;this.componentContainer.firstChild;)this.componentContainer.removeChild(this.componentContainer.lastChild)}clearContainer(t){for(;t.firstChild;)t.removeChild(t.lastChild)}getDate(){const t=new Date,a={day:"numeric",month:"short",year:"numeric"};return t.toLocaleDateString("be-NL",a).toUpperCase()}}var ue=()=>{const i=e.createContainer({className:"loader",innerHTML:"Loading"});return e.createContainer({className:"activityindicator",children:[i]})};class Ce{constructor(t,a){this.parent=t,this.portal=a,this.components=[],this.reRender=null,G(),this.authenticator=new k}clearContainer(t){for(;t.firstChild;)t.removeChild(t.lastChild)}addComponent(t){if(!(t instanceof g))return;const{name:a,routerPath:n}=t;this.authenticator.checkifLoggedIn(),t.reRender=()=>this.showComponent(t),this.components.push(t),d.on(n,()=>{this.showComponent({name:a})}).resolve()}showComponent({name:t}){const a=this.components.find(n=>n.name===t);!a||a&&(this.clearContainer(this.parent),a.render&&this.parent.appendChild(a.render()),a.renderAsync&&(this.portal.appendChild(ue()),a.renderAsync().then(n=>{this.clearContainer(this.portal),this.parent.appendChild(n)}).catch(n=>{console.error(n.message),this.clearContainer(this.portal)})))}}class ve extends g{constructor(){super({name:"login",model:{formData:[{textContent:"<span class='form__label-name'>Email</span>",placeholder:"JohnDoe@gmail.com",type:"text",id:"email",labelClassName:"form__label",inputClassName:"form__input"},{textContent:"<span class='form__label-name'>Password</span>",placeholder:"\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022",type:"password",id:"password",labelClassName:"form__label",inputClassName:"form__input"}]},routerPath:"/"});this.authenticator=new k}render(){this.clearComponentContainer();const{formData:t}=this.model;return this.componentContainer.appendChild(e.createContainer({className:"image-background",id:"image-background"})),this.componentContainer.appendChild(e.createAppName({size:"4"})),this.componentContainer.appendChild(e.createHeader({size:"2",textContent:"Login."})),this.componentContainer.appendChild(e.createText({textContent:"Welcome to Whistle, <br> please sign in"})),this.componentContainer.appendChild(e.createText({className:"error-message"})),this.componentContainer.appendChild(e.createLoginForm({content:t,className:"login-form",buttonName:"Login",onClick:()=>{this.authenticator.login()}})),this.componentContainer.appendChild(e.createHeader({size:4,textContent:"Or login with"})),this.componentContainer.appendChild(e.createContainer({className:"login-authenticate",children:[e.createButton({textContent:'<i class="fab fa-google"></i><p>GOOGLE</p>',className:"button__invite login-authenticate__google",onClick:()=>{this.authenticator.loginWithGoogle()}})]})),this.componentContainer.appendChild(e.createButton({textContent:"New User? Sign Up",className:"button__link",onClick:()=>{d.navigate("/register")}})),this.componentContainer}}class ge extends g{constructor(){super({name:"register",model:{formParams:[{textContent:"<span class='form__label-name'>Email</span>",placeholder:"JohnDoe@gmail.com",type:"text",id:"email",labelClassName:"form__label",inputClassName:"form__input"},{textContent:"<span class='form__label-name'>Username</span>",placeholder:"MasterChief",type:"text",id:"username",labelClassName:"form__label",inputClassName:"form__input",usernameMaxChar:le},{textContent:"<span class='form__label-name'>Password</span>",placeholder:"\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022",type:"password",id:"password",labelClassName:"form__label",inputClassName:"form__input"}]},routerPath:"/register"})}render(){this.clearComponentContainer();const{formParams:t}=this.model;return this.componentContainer.appendChild(e.createContainer({className:"image-background",id:"image-background"})),this.componentContainer.appendChild(e.createAppName({size:"4"})),this.componentContainer.appendChild(e.createHeader({size:"2",textContent:"Register."})),this.componentContainer.appendChild(e.createText({textContent:"Don't have an account yet? <br> Register now!"})),this.componentContainer.appendChild(e.createText({className:"error-message"})),this.componentContainer.appendChild(e.createLoginForm({content:t,className:"register-form",buttonName:"Sign Up",onClick:()=>{this.authenticator.register()}})),this.componentContainer.appendChild(e.createButton({textContent:"Already have an account? <br> Go to login",className:"button__link",onClick:()=>{d.navigate("/")}})),this.componentContainer}}class fe extends g{constructor(){super({name:"info",model:{formData:[{textContent:"<span class='form__label-name'>First Name</span>",placeholder:"Johnny",type:"text",id:"firstName",labelClassName:"form__label",inputClassName:"form__input"},{textContent:"<span class='form__label-name'>Last Name</span>",placeholder:"Doe",type:"text",id:"lastName",labelClassName:"form__label",inputClassName:"form__input"},{textContent:"<span class='form__label-name'>Phone Number</span>",placeholder:"0123/45.67.89",type:"text",id:"phoneNumber",labelClassName:"form__label",inputClassName:"form__input"}]},routerPath:"/info"})}async renderAsync(){this.clearComponentContainer();const{formData:t}=this.model;return this.componentContainer.appendChild(e.createContainer({className:"image-background",id:"image-background"})),this.componentContainer.appendChild(e.createContainer({className:"extra-info",id:"info",children:[e.createAppName({size:"4"}),e.createHeader({size:"2",textContent:"Extra Info."}),e.createText({textContent:"We need some additional <br> information from you"}),e.createLoginForm({content:t,className:"info-form",buttonName:"Confirm",onClick:()=>{this.authenticator.updateData().then(d.navigate("/"))}})]})),this.componentContainer}}class R{constructor(){this.location=new x,this.firestore=w(),this.user=new N,this.audio=new H}async sendAlert(){await this.user.setUserInfo(),await this.location.getCurrentPosition(),setTimeout(async()=>{const t=m(this.firestore,`PanicMessages/${localStorage.getItem("activeEventUID")}/Panics`,this.user.uid);await A(t,{location:await this.location.autoAdressFill(localStorage.getItem("currentPositionCoords").split(",")),distance:localStorage.getItem("currentPositionCoords"),phone:this.user.phoneNumber,user:`${this.user.firstName} ${this.user.lastName}`,userUID:this.user.uid})},3e3)}async removeAlert(){await this.user.setUserInfo(),clearTimeout();const t=m(this.firestore,`PanicMessages/${localStorage.getItem("activeEventUID")}/Panics`,this.user.uid);await U(t)}async listenForPanics(t){if(JSON.parse(localStorage.getItem("eventActive"))){const a=C(u(this.firestore,"PanicMessages",localStorage.getItem("activeEventUID"),"Panics"));W(a,n=>{n.docChanges().forEach(async s=>{s.type==="added"&&s.doc.data().userUID!==this.user.uid&&(this.audio.playPanicPopup(),t.style.opacity="0.6",c("#app").appendChild(e.createContainer({className:"popup-panic-container",children:[e.createHeader({size:4,textContent:`${s.doc.data().user}<br> is <span>panicking</span>`}),e.createContainer({className:"popup-panic-container__location",children:[e.createText({textContent:"Location:"}),e.createText({textContent:s.doc.data().location,className:"data"})]}),e.createText({textContent:`Distance: approx. ${await this.location.calculateDistanceBetweenPoints(s.doc.data().distance.split(","),localStorage.getItem("currentPositionCoords").split(","))}km`}),e.createText({textContent:`Number: ${s.doc.data().phone}`}),e.createContainer({className:"popup-panic-container__button-container",children:[e.createButton({textContent:'Bel <i class="fas fa-phone"></i>',className:"button__invite",onClick:()=>{}}),e.createPopupChatButton({textContent:`<p class="no-display">${s.doc.data().userUID}</p> Chat <i class="fas fa-comment-dots"></i>`,className:"button__invite",onClick:()=>{d.navigate("/chatlist")}})]}),e.createButton({textContent:"Close",className:"button__warning",onClick:()=>{c(".popup-panic-container").remove(),t.style.opacity="1"}})]})))})})}}}class M extends N{constructor(t){super();this.uid=t,this.location=new x}async createEvent(){await this.location.setLocationData(),await this.setUserInfo();const t=new FormData(c(".create__form")),a=t.get("eventTitle"),n=t.get("description"),s=t.get("eventDate"),r=t.get("startTime"),o=t.get("endTime"),l=await P(u(this.firestore,"Events"),{eventTitle:a,createdOn:this.getCreationDate(),description:n,date:s,startTime:r,endTime:o,street:this.location.street,number:this.location.number,city:this.location.city,coords:this.location.coords,hostUID:this.uid,creator:`${this.firstName} ${this.lastName}`,invitedUsers:this.invitedUsers,acceptedUsers:[this.uid]});await this.uploadEventBanner(l.id),await A(m(this.firestore,"Chatrooms",l.id),{eventUID:l.id,name:a,acceptedUsers:[this.uid]})}async editEvent(t){await this.setUserInfo();const a=new FormData(c(".create__form")),n=a.get("eventTitle"),s=a.get("description"),r=a.get("eventDate"),o=a.get("startTime"),l=a.get("endTime");await this.uploadEventBanner(localStorage.getItem("hostedEventUID")),await v(m(this.firestore,"Events",t),{eventTitle:n,description:s,date:r,startTime:o,endTime:l})}async uploadEventBanner(t){const n=new FormData(c(".avatar-overlay__input")).get("avatarImage");if(n.size>0){const s=D(this.storage,`eventBanner/event-${t}`);await O(s,n).then(r=>{j(D(this.storage,s)).then(o=>{v(m(this.firestore,"Events",t),{eventUID:t,eventBannerUrl:o})})})}else v(m(this.firestore,"Events",t),{eventUID:t,eventBannerUrl:"../assets/other/placeholder_event.jpg"})}async InviteMoreFriends(){document.querySelectorAll(".add-people input:checked").forEach(async a=>{await v(m(this.firestore,"Events",localStorage.getItem("hostedEventUID")),{invitedUsers:T(a.id)})})}async StoreAllInvitedUsers(){const t=[];document.querySelectorAll(".add-people input:checked").forEach(async n=>{t.push(n.id)}),this.invitedUsers=t}async deleteEvent(){await U(m(this.firestore,"Events",localStorage.getItem("hostedEventUID"))),await U(m(this.firestore,"Chatrooms",localStorage.getItem("hostedEventUID"))),d.navigate("/my-events")}}class E{constructor(t,a,n,s,r,o,l,h,p){this.uid=t,this.createdOn=h,this.name=a,this.description=n,this.date=s,this.startTime=r,this.endTime=o,this.invitedUsers=l,this.eventBanner=p,this.storage=B(),this.firestore=w(),this.location=new x,this.host=new M,this.audio=new H}async showParticipants(t){this.acceptedUsers.forEach(async a=>{const n=C(u(this.firestore,"Users"),f("uid","==",a)),s=await _(n),r=c(`.${t}`);s.forEach(o=>{o.exists()&&r.appendChild(e.createParticipant({className:"user__avatar",url:o.data().avatarImageUrl,username:o.data().username}))})})}async isEventActive(t,a){const n=C(u(this.firestore,"Events"),f("acceptedUsers","array-contains",t));(await _(n)).forEach(async r=>{await this.compareDate(r.data().date,r.data(),a)})}async compareDate(t,a,n){const s=new Date(t),r=new Date;if(s.setHours(0,0,0,0)===r.setHours(0,0,0,0)){const{startTime:o}=a,{endTime:l}=a,h=new Date,p=new Date(h.getTime());p.setHours(o.split(":")[0]),p.setMinutes(o.split(":")[1]),p.setSeconds(0);const y=new Date(h.getTime());y.setHours(l.split(":")[0]),y.setMinutes(l.split(":")[1]),y.setSeconds(0),p<h&&y>h?(localStorage.setItem("activeEventUID",a.eventUID),localStorage.setItem("eventActive",!0),this.eventActivePopup(n)):localStorage.setItem("eventActive",!1)}}async eventActivePopup(t){await this.getSpecificEvent(localStorage.getItem("activeEventUID")),this.audio.playEventActive();const a=c("#app");t.style.opacity="0.6",a.appendChild(e.createContainer({className:"popup-container",children:[e.createHeader({size:4,textContent:`${this.name}<br>has started!`}),e.createText({textContent:"Go to TAKE CARE MODE?"}),e.createContainer({className:"popup-container__button-container",children:[e.createButton({textContent:"No, Go back",className:"button__reject",onClick:()=>{c(".popup-container").remove(),t.style.opacity="1"}}),e.createButton({textContent:"Take Care",className:"button__accept",onClick:()=>{d.navigate("/take-care-mode")}})]})]}))}async getHostedEvents(){await this.host.setUserInfo();const t=c(".host-container"),a=C(u(this.firestore,"Events"),f("hostUID","==",this.host.uid),z("date"));(await _(a)).forEach(async s=>{s.exists()&&t.appendChild(e.createEventCard({onClick:()=>{d.navigate("/my-hosted-event")},url:s.data().eventBannerUrl,eventUID:s.id,eventTime:`${s.data().startTime} - ${s.data().endTime}`,eventName:s.data().eventTitle,eventDate:this.ModifyDate(s.data().date)}))})}async getEventInvitations(){await this.host.setUserInfo();const t=c(".invitation-container"),a=C(u(this.firestore,"Events"),f("invitedUsers","array-contains",this.host.uid));(await _(a)).forEach(s=>{s.exists()&&t.appendChild(e.createInviteButton({onClick:()=>{d.navigate("/my-event-invitation")},className:"invitation__button",textContent:`${s.data().eventTitle} <i class='fas fa-chevron-circle-right fa-lg'></i>`,eventUID:s.id}))})}async getUpcomingEvents(){await this.host.setUserInfo();const t=c(".upcoming-events-container"),a=C(u(this.firestore,"Events"),f("acceptedUsers","array-contains",this.host.uid));(await _(a)).forEach(s=>{s.exists()&&t.appendChild(e.createEventCard({onClick:()=>{d.navigate("/my-upcoming-event")},url:s.data().eventBannerUrl,eventUID:s.id,eventTime:`${s.data().startTime} - ${s.data().endTime}`,eventName:s.data().eventTitle,eventDate:this.ModifyDate(s.data().date)}))})}async getSpecificEvent(t){const a=m(this.firestore,"Events",t),n=await I(a);n.exists()?(this.uid=n.id,this.name=n.data().eventTitle,this.description=n.data().description,this.date=n.data().date,this.createdOn=n.data().createdOn,this.startTime=n.data().startTime,this.endTime=n.data().endTime,this.acceptedUsers=n.data().acceptedUsers,this.invitedUsers=n.data().invitedUsers,this.eventBanner=n.data().eventBannerUrl,this.location.setEventLocationData({street:n.data().street,city:n.data().city,number:n.data().number,coords:n.data().coords}),this.host.username=n.data().creator):console.log("No such document!")}ModifyDate(t){const a=new Date(t),n={day:"numeric"},s=a.toLocaleDateString("be-NL",n).toUpperCase(),r={month:"short"},o=a.toLocaleDateString("be-NL",r).toUpperCase();return`${s}<br>${o}`}modifyDateFull(t){const a=new Date(t),n={day:"numeric",month:"short",year:"numeric"};return a.toLocaleDateString("be-NL",n)}}class _e extends g{constructor(){super({name:"home",routerPath:"/home"});this.user=new N,this.authenticator=new k,this.panic=new R,this.location=new x,this.event=new E}async renderAsync(){return this.clearComponentContainer(),await this.user.setUserInfo(),await this.user.getAvatar(),await this.location.getCurrentPosition(),localStorage.getItem("activeEventUID")&&await this.panic.listenForPanics(this.componentContainer),await this.event.isEventActive(JSON.parse(localStorage.getItem("user")).uid,this.componentContainer),this.componentContainer.appendChild(e.createContainer({className:"image-background",id:"image-background2"})),this.componentContainer.appendChild(e.createHeaderNav({containerClassName:"header-nav-container",title:"WH<span>!</span>STLE HOME",subTitle:this.getDate()})),this.componentContainer.appendChild(e.createContainer({className:"home-list",children:[e.createHeader({size:5,textContent:`Welcome ${this.user.username}`}),e.createText({textContent:"what would you like to do?"}),e.createHorizontalRule({size:1,className:"horizontal-line"}),e.createIcon({className:"fas fa-th fa-2x home-list__grid-icon",onClick:()=>{d.navigate("/home-grid")}}),e.createHomeItem({textContent:"Create Event",className:" home-list__item",iconClass:" fas fa-plus-square fa-lg",onClick:()=>{d.navigate("/create-event")}}),e.createHomeItem({textContent:"My Events",className:" home-list__item",iconClass:" fas fa-ticket-alt fa-lg",onClick:()=>{d.navigate("/my-events")}}),e.createHomeItem({textContent:"Friend List",className:" home-list__item",iconClass:"fas fa-user-friends fa-lg",onClick:()=>{d.navigate("/friend-list")}}),e.createHomeItem({textContent:"Chatrooms",className:" home-list__item",iconClass:" fas fa-comment-dots fa-lg",onClick:()=>{d.navigate("/chatlist")}}),e.createHomeItem({textContent:"Meldet.org",className:" home-list__item",iconClass:" fas fa-exclamation-triangle fa-lg",onClick:()=>{d.navigate("/meldet")}}),e.createHomeItem({textContent:"Account Settings",className:" home-list__item",iconClass:" fas fa-cogs fa-lg",onClick:()=>{d.navigate("/account-settings")}}),e.createHomeItem({textContent:"Logout",className:" home-list__item",iconClass:" fas fa-power-off fa-lg",onClick:()=>{localStorage.removeItem("user"),this.authenticator.logout()}})]})),JSON.parse(localStorage.getItem("eventActive"))&&this.componentContainer.appendChild(e.createButton({textContent:'WHISTLE <i class="fas fa-exclamation-circle"></i>',className:"button__panic home-list__whistle",onClick:()=>{c(".button__panic").className==="button__panic home-list__whistle"?(c(".button__panic").className="button__panic home-list__whistle--active",this.panic.sendAlert()):(c(".button__panic").className="button__panic home-list__whistle",this.panic.removeAlert())}})),this.componentContainer}}class ye extends g{constructor(){super({name:"home-grid",routerPath:"/home-grid"});this.user=new N,this.authenticator=new k,this.panic=new R,this.location=new x,this.event=new E}async renderAsync(){return this.clearComponentContainer(),await this.user.setUserInfo(),await this.user.getAvatar(),await this.location.getCurrentPosition(),localStorage.getItem("activeEventUID")&&await this.panic.listenForPanics(this.componentContainer),await this.event.isEventActive(JSON.parse(localStorage.getItem("user")).uid,this.componentContainer),this.componentContainer.appendChild(e.createContainer({className:"image-background",id:"image-background2"})),this.componentContainer.appendChild(e.createHeaderNav({containerClassName:"header-nav-container",title:"WH<span>!</span>STLE HOME",subTitle:this.getDate()})),this.componentContainer.appendChild(e.createContainer({className:"home-grid",children:[e.createHeader({size:5,textContent:`Welcome ${this.user.username}`}),e.createText({textContent:"what would you like to do?"}),e.createHorizontalRule({size:1,className:"horizontal-line"}),e.createIcon({className:"fas fa-list fa-2x home-list__grid-icon",onClick:()=>{d.navigate("/home")}}),e.createContainer({className:"home-grid__container",children:[e.createHomeItem({textContent:"Create Event",className:"home-grid__item",iconClass:" fas fa-plus-square fa-lg",onClick:()=>{d.navigate("/create-event")}}),e.createHomeItem({textContent:"My Events",className:"home-grid__item",iconClass:" fas fa-ticket-alt fa-lg",onClick:()=>{d.navigate("/my-events")}}),e.createHomeItem({textContent:"Chat<br>rooms",className:"home-grid__item",iconClass:" fas fa-comment-dots fa-lg",onClick:()=>{d.navigate("/chatlist")}}),e.createHomeItem({textContent:"Meldet<br>.org",className:"home-grid__item",iconClass:" fas fa-exclamation-triangle fa-lg",onClick:()=>{d.navigate("/meldet")}}),e.createHomeItem({textContent:"Account Settings",className:"home-grid__item",iconClass:" fas fa-cogs fa-lg",onClick:()=>{d.navigate("/account-settings")}}),e.createHomeItem({textContent:"Friend List",className:"home-grid__item",iconClass:"fas fa-user-friends fa-lg",onClick:()=>{d.navigate("/friend-list")}}),e.createHomeItem({textContent:"Logout",className:"home-grid__item",iconClass:" fas fa-power-off fa-lg",onClick:()=>{localStorage.removeItem("user"),this.authenticator.logout()}})]})]})),JSON.parse(localStorage.getItem("eventActive"))&&this.componentContainer.appendChild(e.createButton({textContent:'WHISTLE <i class="fas fa-exclamation-circle"></i>',className:"button__panic home-list__whistle",onClick:()=>{c(".button__panic").className==="button__panic home-list__whistle"?(c(".button__panic").className="button__panic home-list__whistle--active",this.panic.sendAlert()):(c(".button__panic").className="button__panic home-list__whistle",this.panic.removeAlert())}})),this.componentContainer}}class Ne extends g{constructor(){super({name:"account-settings",routerPath:"/account-settings"});this.user=new N}async renderAsync(){this.clearComponentContainer(),await this.user.setUserInfo(),await this.user.getAvatar(),this.componentContainer.appendChild(e.createContainer({className:"image-background",id:"image-background2"})),this.componentContainer.appendChild(e.createHeaderNav({containerClassName:"header-nav-container",title:"WH<span>!</span>STLE ACCOUNT",subTitle:"Account Settings"})),this.componentContainer.appendChild(e.createContainer({className:"account-container",children:[e.createHeader({size:3,textContent:"My Account."}),e.createText({textContent:"Review or Update <br>your account settings."}),e.createFormWithNormalLabel({content:[{textContent:"Username",placeholder:this.user.username,type:"text",id:"username",labelClassName:"form__account-label",inputClassName:"form__account-input",disabled:!0,onClick:()=>{const a=c("#username");a.disabled=!1}},{textContent:"First Name",placeholder:this.user.firstName,type:"text",id:"firstName",labelClassName:"form__account-label",inputClassName:"form__account-input",disabled:!0,onClick:()=>{const a=c("#firstName");a.disabled=!1}},{textContent:"Last Name",placeholder:this.user.lastName,type:"text",id:"lastName",labelClassName:"form__account-label",inputClassName:"form__account-input",disabled:!0,value:this.user.lastName,onClick:()=>{const a=c("#lastName");a.disabled=!1}},{textContent:"Phone Number",placeholder:this.user.phoneNumber,type:"text",id:"phoneNumber",labelClassName:"form__account-label",inputClassName:"form__account-input",disabled:!0,onClick:()=>{const a=c("#phoneNumber");a.disabled=!1}}],className:"account-form"}),e.createLabel({textContent:"Avatar",className:"avatar-label"}),e.createHorizontalRule({size:2,className:"avatar-rule"}),e.createButton({textContent:"Change avatar picture..",className:"button__normal--avatar",onClick:()=>{const a=c(".avatar-overlay");a.className="avatar-overlay"}}),e.createButton({textContent:"Save Account Settings",className:"button__invite",onClick:async()=>{const a=new FormData(c(".account-form"));await this.user.updateUserInfo(a.get("username")?a.get("username"):this.user.username,a.get("firstName")?a.get("firstName"):this.user.firstName,a.get("lastName")?a.get("lastName"):this.user.lastName,a.get("phoneNumber")?a.get("phoneNumber"):this.user.phoneNumber).then(()=>{d.navigate("/home")})}}),e.createButton({textContent:"LOGOUT",className:"button__normal",onClick:()=>{this.authenticator.logout()}}),e.createButton({textContent:"REMOVE ACCOUNT",className:"button__warning",onClick:()=>{c(".delete-account-overlay").className="delete-account-overlay"}})]}));const t=document.createElement("form");return t.className="avatar-overlay__input",t.appendChild(e.createButton({textContent:"Upload Image...",className:"button__normal avatar-overlay__button"})),t.appendChild(e.createInput({type:"file",className:"avatar-overlay__file",name:"avatarImage",id:"avatarImage"})),this.componentContainer.appendChild(e.createContainer({className:"avatar-overlay hide",children:[e.createHeader({className:"avatar-overlay__header",size:2,textContent:" Choose <br>Your Avatar."}),e.createAvatarRadioButton({className:"avatar",avatarArray:["alien","bunny","cat","dog","frog","panda","piglet","pinguin","robot"],size:"70px"}),e.createHeader({size:3,textContent:"OR",className:"avatar-overlay__text"}),t,e.createButton({textContent:"SAVE",className:"button__invite avatar-overlay__button--save",onClick:async()=>{if(c("input:checked")){const a=c('input[name="avatarImage"]:checked').value;await this.user.updateUserImage(a)}else{const n=new FormData(c(".avatar-overlay__input")).get("avatarImage");this.user.uploadAvatar(n).then(()=>{this.user.getAvatar()})}c(".avatar-overlay").className="avatar-overlay hide",this.clearComponentContainer(),this.renderAsync()}})]})),this.componentContainer.appendChild(e.createContainer({className:"delete-account-overlay hide",children:[e.createHeader({className:"delete-account-overlay__header",size:2,textContent:'Are you sure you want to <span>delete</span> your account?"'}),e.createContainer({className:"delete-account-overlay__button-container",children:[e.createButton({textContent:"NO",className:"button__accept",onClick:()=>{c(".delete-account-overlay").className="delete-account-overlay hide"}}),e.createButton({textContent:"YES",className:"button__reject",onClick:()=>{c(".delete-account-overlay").className="delete-account-overlay hide",c(".credentials-overlay").className="credentials-overlay"}})]})]})),this.componentContainer.appendChild(e.createContainer({className:"credentials-overlay hide",children:[e.createHeader({className:"credentials-overlay__header",size:3,textContent:"Please insert E-mail and Password to <span>delete</span> your account"}),e.createContainer({className:"credentials-overlay__credential-container",children:[e.createFormWithNormalLabel({content:[{textContent:"E-mail",placeholder:this.user.email,type:"email",id:"email",labelClassName:"form__account-label",inputClassName:"form__account-input"},{textContent:"Password",placeholder:"Your password",type:"password",id:"password",labelClassName:"form__account-label",inputClassName:"form__account-input"}]}),e.createButton({textContent:"DELETE",className:"button__warning",onClick:()=>{this.user.deleteAccount()}})]})]})),this.componentContainer}}class xe extends g{constructor(){super({name:"create-event",routerPath:"/create-event"});this.host=new M,this.location=new x,this.firestore=w()}async renderAsync(){this.clearComponentContainer(),await this.host.setUserInfo(),await this.host.getAllFriends(),this.host.StoreAllInvitedUsers(),this.componentContainer.appendChild(e.createContainer({className:"image-background",id:"image-background2"}));const t=document.createElement("form");t.className="create__form";const a=document.createElement("div");a.className="form",this.componentContainer.appendChild(e.createHeaderNav({containerClassName:"header-nav-container",title:"WH<span>!</span>STLE CREATE",subTitle:"Create your own event!"})),this.componentContainer.appendChild(e.createContainer({className:"create__text",children:[e.createHeader({size:3,textContent:"Create."}),e.createText({textContent:"Create your event<br>and invite friends."})]})),a.appendChild(e.createContainer({children:[e.createInput({className:"form__input",type:"text",id:"eventTitle",required:!0,maxChar:de}),e.createLabel({textContent:"<span class='form__label-name'>Event Title</span>",className:"form__label"})]}));const n=document.createElement("textarea");n.name="description",n.maxLength=200,a.appendChild(e.createContainer({className:"form__textarea",children:[e.createLabel({textContent:"Description",className:"form__account-label"}),n]})),a.appendChild(e.createContainer({children:[e.createInput({className:"form__input",type:"date",id:"eventDate",required:!0}),e.createLabel({textContent:"Event Date",className:"form__label"})]})),a.appendChild(e.createContainer({children:[e.createInput({className:"form__input",type:"time",id:"startTime",required:!0}),e.createLabel({textContent:"Start of Event",className:"form__label"})]})),a.appendChild(e.createContainer({children:[e.createInput({className:"form__input",type:"time",id:"endTime",required:!0}),e.createLabel({textContent:"End of Event",className:"form__label"})]})),a.appendChild(e.createContainer({children:[e.createInput({className:"form__input",type:"text",id:"location",required:!0}),e.createLabel({textContent:"<span class='form__label-name'>Location</span>",className:"form__label"})]})),a.appendChild(e.createButton({textContent:"Check Location",className:"button__invite location-button",onClick:async()=>{await this.location.checkLocation(),await this.location.setLocationData()}})),a.appendChild(e.createContainer({id:"mapContainer"}));const s=document.createElement("form");return s.className="avatar-overlay__input",s.appendChild(e.createButton({textContent:"Upload Image...",className:"button__normal avatar-overlay__button"})),s.appendChild(e.createInput({type:"file",className:"avatar-overlay__file",name:"avatarImage",id:"avatarImage"})),a.appendChild(e.createContainer({className:"form__input",children:[e.createLabel({textContent:"Event Banner",className:"form__account-label"}),s]})),a.appendChild(e.createContainer({className:"form__input",children:[e.createLabel({textContent:"Invite Friends",className:"form__account-label"}),e.createButton({textContent:"Invite friends",className:"button__normal--friends",onClick:()=>{const r=c(".add-users-overlay");r.className="add-users-overlay";const o=c(".add-users-container");this.host.friends.forEach(async l=>{const h=C(u(this.firestore,"Users"),f("uid","==",l));(await _(h)).forEach(y=>{o.appendChild(e.createAddPeople({avatarUrl:y.data().avatarImageUrl,username:y.data().username,uid:y.data().uid}))})})}})]})),a.appendChild(e.createButton({textContent:"Create Event",className:"button__invite create-button",onClick:async()=>{await this.host.createEvent().then(()=>{d.navigate("/home")})}})),this.componentContainer.appendChild(e.createContainer({className:"add-users-overlay hide",children:[e.createHeader({className:"add-users-overlay__header",size:2,textContent:"Who do you <br> want to add?"}),e.createContainer({className:"add-users-container"}),e.createButton({textContent:"Add",className:"button__invite--add",onClick:()=>{this.host.StoreAllInvitedUsers();const r=c(".add-users-overlay");r.className="add-users-overlay hide"}})]})),t.appendChild(a),this.componentContainer.appendChild(t),this.componentContainer}}class be{constructor(t,a,n,s){this.title=t,this.adress=a,this.description=n,this.category=s}getInformation(){const t=new FormData(c("form"));this.title=t.get("title"),this.adress=t.get("adress"),this.description=t.get("descriptionMeldet"),this.category=t.get("category"),console.log(this.title,this.adress,this.description,this.category)}SubmitReport(){J.setApiKey("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");const t=new FormData(c("form")),a=t.get("title"),n=t.get("adress"),s=t.get("descriptionMeldet"),r=t.get("category"),o={to:ce,from:JSON.parse(localStorage.getItem("user")).email,category:r,subject:a,adress:n,text:s};J.send(o).then(()=>{console.log("email sent"),console.log(`From: ${o.from} 
To: ${o.to} 
Adress: ${o.adress}
Category: ${o.category}
Subject: ${o.subject}
Description: ${o.text}`)}).catch(l=>{console.error(l)})}}class we extends g{constructor(){super({name:"meldet",routerPath:"/meldet"});this.location=new x}async renderAsync(){this.clearComponentContainer(),await this.location.getCurrentPosition();const t=document.createElement("form");t.className="meldet__form";const a=document.createElement("div");return a.className="form",this.componentContainer.appendChild(e.createContainer({className:"image-background",id:"image-background2"})),this.componentContainer.appendChild(e.createHeaderNav({containerClassName:"header-nav-container",title:"WH<span>!</span>STLE MELDET",subTitle:"Report harrasment"})),this.componentContainer.appendChild(e.createContainer({className:"meldet__text",children:[e.createHeader({size:3,textContent:"REPORT TO <br> MELDET.ORG"})]})),a.appendChild(e.createContainer({children:[e.createInput({className:"form__input",type:"text",id:"title",required:!0}),e.createLabel({textContent:"<span class='form__label-name'>Title (or keyword)</span>",className:"form__label"})]})),a.appendChild(e.createContainer({children:[e.createInput({className:"form__input",type:"text",id:"adress",required:!0}),e.createLabel({textContent:"<span class='form__label-name'>Adress</span>",className:"form__label"}),e.createIcon({className:"fas fa-compass fa-2x location-icon",onClick:async()=>{await this.location.getCurrentPosition().then(async()=>{await this.location.autoAdressFill(localStorage.getItem("currentPositionCoords").split(",")),c("#adress").value=`${this.location.street}, ${this.location.number}, ${this.location.city}`})}})]})),a.appendChild(e.createContainer({children:[e.createInput({className:"form__input",type:"text",id:"descriptionMeldet",required:!0}),e.createLabel({textContent:"<span class='form__label-name'>Description (optional)</span>",className:"form__label"})]})),a.appendChild(e.createContainer({className:"meldet-select",children:[e.createCategoryList({categories:me,className:"category",placeholder:"Choose a category"})]})),a.appendChild(e.createButton({textContent:"SUBMIT",className:"button__invite",onClick:()=>{const n=new be;n.getInformation(),n.SubmitReport()}})),t.appendChild(a),this.componentContainer.appendChild(t),this.componentContainer}}class Ee extends g{constructor(){super({name:"friend-list",routerPath:"/friend-list"});this.user=new N}async renderAsync(){return this.clearComponentContainer(),await this.user.setUserInfo(),await this.user.getAllFriends(),await this.user.getAllUsers(),this.user.showFriendRequest(this),this.componentContainer.appendChild(e.createContainer({className:"image-background",id:"image-background2"})),this.componentContainer.appendChild(e.createHeaderNav({containerClassName:"header-nav-container",title:"WH<span>!</span>STLE FRIENDS",subTitle:"Stay connected with friends!"})),this.componentContainer.appendChild(e.createContainer({className:"friend-container",children:[e.createHeader({size:5,textContent:"My Friend List."}),e.createHorizontalRule({size:2}),e.createIcon({className:"fas fa-user-plus fa-2x friend-icon",onClick:()=>{const t=c(".friend-overlay");t.className="friend-overlay";const a=c(".add-users-container");this.user.allUsers&&this.user.friends&&this.user.allUsers.forEach(n=>{!this.user.friends.includes(n.uid)&&!this.user.friendRequests.includes(n.uid)&&a.appendChild(e.createAddPeople({avatarUrl:n.avatarImageUrl,username:n.username,uid:n.uid}))})}}),e.createContainer({className:"friends-container",children:[e.createContainer({className:"friends-container__invitation-container",children:[e.createLabel({textContent:"Invitations",className:"friends-container__label-invitations"})]}),e.createContainer({className:"friends-container__accepted-container",children:[e.createLabel({textContent:"Friends",className:"friends-container__friends-label"})]})]})]})),this.componentContainer.appendChild(e.createContainer({className:"friend-overlay hide",children:[e.createHeader({className:"friend-overlay__header",size:2,textContent:"Who do you <br> want to add?"}),e.createContainer({className:"add-users-container"}),e.createButton({textContent:"Add",className:"button__invite--add",onClick:async()=>{await this.user.addFriends().then(async()=>{this.clearComponentContainer(),this.renderAsync()})}})]})),await this.user.showFriends(this),this.componentContainer}}class Ie extends g{constructor(){super({name:"my-events",routerPath:"/my-events"});this.event=new E}async renderAsync(){return this.clearComponentContainer(),this.event.getEventInvitations(),this.event.getHostedEvents(),this.event.getUpcomingEvents(),this.event.isEventActive(JSON.parse(localStorage.getItem("user")).uid,this.componentContainer),this.componentContainer.appendChild(e.createContainer({className:"image-background",id:"image-background2"})),this.componentContainer.appendChild(e.createHeaderNav({containerClassName:"header-nav-container",title:"WH<span>!</span>STLE EVENTS",subTitle:"Current and upcoming events!"})),this.componentContainer.appendChild(e.createContainer({className:"my-events",children:[e.createHeader({size:5,textContent:"Invitations",className:"my-events__title"}),e.createHorizontalRule({size:2}),e.createContainer({className:"invitation-container"}),e.createHeader({size:5,textContent:"Hosted Events",className:"my-events__title"}),e.createHorizontalRule({size:2}),e.createContainer({className:"host-container"}),e.createHeader({size:5,textContent:"Upcoming Events",className:"my-events__title"}),e.createHorizontalRule({size:2}),e.createContainer({className:"upcoming-events-container"})]})),this.componentContainer}}class Se extends g{constructor(){super({name:"my-hosted-event",routerPath:"/my-hosted-event"});this.event=new E,this.host=new M,this.firestore=w(),this.location=new x}async renderAsync(){return this.clearComponentContainer(),await this.host.setUserInfo(),await this.host.getAllFriends(),await this.event.getSpecificEvent(localStorage.getItem("hostedEventUID")),await this.event.showParticipants("my-hosted-events__participants--container"),this.componentContainer.appendChild(e.createContainer({className:"image-background",id:"image-background2"})),this.componentContainer.appendChild(e.createHeaderNav({containerClassName:"header-nav-container",title:"WH<span>!</span>STLE HOST",subTitle:"Details on your event"})),this.componentContainer.appendChild(e.createImageDiv({className:"my-hosted-events__image",url:this.event.eventBanner})),this.componentContainer.appendChild(e.createContainer({className:"my-hosted-events",children:[e.createContainer({className:"my-hosted-events__title-container",children:[e.createHeader({size:5,className:"my-hosted-events__text",textContent:this.event.name}),e.createIcon({className:"fas fa-edit fa-2x",id:"editEvent",onClick:()=>{d.navigate("/edit-event")}})]}),e.createHeader({size:5,className:"my-hosted-events__description--title",textContent:"Description."}),e.createHorizontalRule({size:2}),e.createText({className:"my-hosted-events__description",textContent:this.event.description}),e.createHeader({size:5,className:"my-hosted-events__information--title",textContent:"Information."}),e.createHorizontalRule({size:2}),e.createContainer({className:"information-container",children:[e.createContainer({className:"my-hosted-events__information",children:[e.createText({textContent:`Created on: ${this.event.createdOn} `}),e.createText({textContent:`Created by: ${this.event.host.username} `}),e.createText({textContent:`Date: ${this.event.modifyDateFull(this.event.date)}`}),e.createText({textContent:`Event start: ${this.event.startTime}`}),e.createText({textContent:`Event end: ${this.event.endTime}`})]}),e.createContainer({className:"my-hosted-events__map",children:[e.createMap({searchContainer:"my-hosted-events__map",coords:this.event.location.coords}),e.createText({textContent:`${this.event.location.street} ${this.event.location.number}, ${this.event.location.city}`})]})]}),e.createHeader({size:5,className:"my-hosted-events__participants--title",textContent:"Participants."}),e.createHorizontalRule({size:2}),e.createContainer({className:"my-hosted-events__participants--container"}),e.createButton({textContent:"Invite more people",className:" button__invite my-hosted-events__button--invite",onClick:()=>{const t=c(".add-users-overlay");t.className="add-users-overlay";const a=c(".add-users-container");this.host.friends.forEach(async n=>{const s=C(u(this.firestore,"Users"),f("uid","==",n));(await _(s)).forEach(o=>{!this.event.acceptedUsers.includes(o.data().uid)&&!this.event.invitedUsers.includes(o.data().uid)&&a.appendChild(e.createAddPeople({avatarUrl:o.data().avatarImageUrl,username:o.data().username,uid:o.data().uid}))})})}}),e.createButton({textContent:"Go to Chatroom of Event",className:" button__normal my-hosted-events__button--normal",onClick:()=>{localStorage.setItem("chatroomID",this.event.uid),d.navigate("/chatroom")}}),e.createButton({textContent:"DELETE EVENT",className:" button__warning my-hosted-events__button--warning",onClick:()=>{c(".delete-event-overlay").className="delete-event-overlay"}})]})),this.componentContainer.appendChild(e.createContainer({className:"delete-event-overlay hide",children:[e.createHeader({className:"delete-event-overlay__header",size:2,textContent:`Are you sure you want to <span>delete</span> "${this.event.name}" `}),e.createContainer({className:"delete-event-overlay__button-container",children:[e.createButton({textContent:"NO",className:"button__accept",onClick:()=>{c(".delete-event-overlay").className="delete-event-overlay hide"}}),e.createButton({textContent:"YES",className:"button__reject",onClick:()=>{this.host.deleteEvent()}})]})]})),this.componentContainer.appendChild(e.createContainer({className:"add-users-overlay hide",children:[e.createHeader({className:"add-users-overlay__header",size:2,textContent:"Who do you <br> want to add?"}),e.createContainer({className:"add-users-container"}),e.createButton({textContent:"Add",className:"button__invite--add",onClick:async()=>{await this.host.InviteMoreFriends().then(()=>{this.clearComponentContainer(),this.renderAsync()})}})]})),this.componentContainer}}class V extends N{constructor(t){super();this.uid=t}async acceptInvite(){await this.setUserInfo();const t=m(this.firestore,"Events",localStorage.getItem("invitedEvent")),a=m(this.firestore,"Chatrooms",localStorage.getItem("invitedEvent"));await v(t,{invitedUsers:b(this.uid),acceptedUsers:T(this.uid)}),await v(a,{acceptedUsers:T(this.uid)})}async rejectInvite(){await this.setUserInfo();const t=m(this.firestore,"Events",localStorage.getItem("invitedEvent"));await v(t,{invitedUsers:b(this.uid)})}async leaveEvent(){await this.setUserInfo();const t=m(this.firestore,"Events",localStorage.getItem("hostedEventUID"));await v(t,{acceptedUsers:b(this.uid)})}}class Te extends g{constructor(){super({name:"my-event-invitation",routerPath:"/my-event-invitation"});this.event=new E,this.participant=new V}async renderAsync(){return this.clearComponentContainer(),await this.event.getSpecificEvent(localStorage.getItem("invitedEvent")),await this.event.showParticipants("my-event-invitation__participants--container"),this.componentContainer.appendChild(e.createContainer({className:"image-background",id:"image-background2"})),this.componentContainer.appendChild(e.createHeaderNav({containerClassName:"header-nav-container",title:"WH<span>!</span>STLE HOST",subTitle:"Details on your event"})),this.componentContainer.appendChild(e.createImageDiv({className:"my-event-invitation__image",url:this.event.eventBanner})),this.componentContainer.appendChild(e.createContainer({className:"my-event-invitation",children:[e.createHeader({size:5,className:"my-event-invitation__text",textContent:this.event.name}),e.createHeader({size:5,className:"my-event-invitation__description--title",textContent:"Description."}),e.createHorizontalRule({size:2}),e.createText({className:"my-event-invitation__description",textContent:this.event.description}),e.createHeader({size:5,className:"my-event-invitation__information--title",textContent:"Information."}),e.createHorizontalRule({size:2}),e.createContainer({className:"information-container",children:[e.createContainer({className:"my-event-invitation__information",children:[e.createText({textContent:`Created on: ${this.event.createdOn} `}),e.createText({textContent:`Created by: ${this.event.host.username} `}),e.createText({textContent:`Date: ${this.event.modifyDateFull(this.event.date)}`}),e.createText({textContent:`Event start: ${this.event.startTime}`}),e.createText({textContent:`Event end: ${this.event.endTime}`})]}),e.createContainer({className:"my-event-invitation__map",children:[e.createMap({searchContainer:"my-event-invitation__map",coords:this.event.location.coords}),e.createText({textContent:`${this.event.location.street} ${this.event.location.number}, ${this.event.location.city}`})]})]}),e.createHeader({size:5,className:"my-event-invitation__participants--title",textContent:"Participants."}),e.createHorizontalRule({size:2}),e.createContainer({className:"my-event-invitation__participants--container"}),e.createContainer({className:"my-event-invitation__button-container",children:[e.createButton({textContent:"REJECT ",className:"button__reject",onClick:async()=>{await this.participant.rejectInvite(),d.navigate("/my-events")}}),e.createButton({textContent:"ACCEPT",className:"button__accept",onClick:async()=>{await this.participant.acceptInvite(),d.navigate("/my-events")}})]})]})),this.componentContainer}}class Ue extends g{constructor(){super({name:"my-upcoming-event",routerPath:"/my-upcoming-event"});this.event=new E,this.participant=new V}async renderAsync(){return this.clearComponentContainer(),await this.event.getSpecificEvent(localStorage.getItem("hostedEventUID")),this.componentContainer.appendChild(e.createContainer({className:"image-background",id:"image-background2"})),this.componentContainer.appendChild(e.createHeaderNav({containerClassName:"header-nav-container",title:"WH<span>!</span>STLE HOST",subTitle:"Details on the event"})),this.componentContainer.appendChild(e.createImageDiv({className:"my-upcoming-event__image",url:this.event.eventBanner})),this.componentContainer.appendChild(e.createContainer({className:"my-upcoming-event",children:[e.createHeader({size:5,className:"my-upcoming-event__text",textContent:this.event.name}),e.createHeader({size:5,className:"my-upcoming-event__description--title",textContent:"Description."}),e.createHorizontalRule({size:2}),e.createText({className:"my-upcoming-event__description",textContent:this.event.description}),e.createHeader({size:5,className:"my-upcoming-event__information--title",textContent:"Information."}),e.createHorizontalRule({size:2}),e.createContainer({className:"information-container",children:[e.createContainer({className:"my-upcoming-event__information",children:[e.createText({textContent:`Created on: ${this.event.createdOn} `}),e.createText({textContent:`Created by: ${this.event.host.username} `}),e.createText({textContent:`Date: ${this.event.modifyDateFull(this.event.date)}`}),e.createText({textContent:`Event start: ${this.event.startTime}`}),e.createText({textContent:`Event end: ${this.event.endTime}`})]}),e.createContainer({className:"my-upcoming-event__map",children:[e.createMap({searchContainer:"my-upcoming-event__map",coords:this.event.location.coords}),e.createText({textContent:`${this.event.location.street} ${this.event.location.number}, ${this.event.location.city}`})]})]}),e.createHeader({size:5,className:"my-upcoming-event__participants--title",textContent:"Participants."}),e.createHorizontalRule({size:2}),e.createContainer({className:"my-upcoming-event__participants--container"}),e.createButton({textContent:"Go to Chatroom of Event",className:" button__normal my-hosted-events__button--normal",onClick:()=>{localStorage.setItem("chatroomID",this.event.uid),d.navigate("/chatroom")}}),e.createButton({textContent:"LEAVE EVENT",className:" button__warning my-hosted-events__button--warning",onClick:()=>{c(".leave-event-overlay").className="leave-event-overlay"}})]})),this.componentContainer.appendChild(e.createContainer({className:"leave-event-overlay hide",children:[e.createHeader({className:"leave-event-overlay__header",size:2,textContent:`Are you sure you want to <span>leave</span> "${this.event.name}" `}),e.createContainer({className:"leave-event-overlay__button-container",children:[e.createButton({textContent:"NO",className:"button__accept",onClick:()=>{c(".leave-event-overlay").className="leave-event-overlay hide"}}),e.createButton({textContent:"YES",className:"button__reject",onClick:()=>{this.participant.leaveEvent(),d.navigate("/my-events")}})]})]})),await this.event.showParticipants("my-upcoming-event__participants--container"),this.componentContainer}}class F{constructor(t){this.uid=t,this.firestore=w(),this.user=new N,this.audio=new H}async getFriendsChatrooms(){await this.user.setUserInfo(),await this.user.getAllFriends();const t=c(".chat-container");this.user.friends.forEach(async a=>{const n=await I(m(this.firestore,"Users",a));if(n.exists()){const s=C(u(this.firestore,"Chatrooms"),f("usersUID","array-contains",a));(await _(s)).forEach(o=>{o.data().usersUID.includes(this.user.uid)&&t.appendChild(e.createChatroomCard({eventUID:o.data().chatroomUID,url:n.data().avatarImageUrl,classname:"chatroom-card",username:`${n.data().username}`,onClick:async()=>{localStorage.setItem("friendUIDChat",n.data().uid),await this.user.getSpecificFriend(localStorage.getItem("friendUIDChat")),d.navigate("/chatroom-friend")}}))})}})}async getEventChatrooms(){await this.user.setUserInfo();const t=c(".event-chat-container"),a=C(u(this.firestore,"Chatrooms"),f("acceptedUsers","array-contains",this.user.uid));(await _(a)).forEach(s=>{t.appendChild(e.createChatroomCard({url:"../assets/other/cityscape.svg",eventUID:s.data().eventUID,classname:"chatroom-card",username:s.data().name,onClick:()=>{d.navigate("/chatroom")}}))})}async sendMessage(){await this.user.setUserInfo();const t=c("#chatInput"),a=u(this.firestore,"Chatrooms",localStorage.getItem("chatroomID"),"Messages");t.value!==""&&await P(a,{message:t.value,user:this.user.username,time:this.changeDate(),timestamp:ie()}).then(()=>{t.value=""})}async getMessages(){await this.user.setUserInfo();const t=C(u(this.firestore,"Chatrooms",localStorage.getItem("chatroomID"),"Messages"),z("timestamp"));W(t,a=>{const n=c(".chat__field");a.docChanges().forEach(s=>{s.type==="added"&&(s.doc.data().user===this.user.username?n.appendChild(e.createContainer({className:"chat__bubble--me",children:[e.createText({textContent:s.doc.data().message}),e.createSmall({textContent:`${s.doc.data().user} | ${s.doc.data().time} `})]})):(this.audio.playMessage(),n.appendChild(e.createContainer({className:"chat__bubble--other",children:[e.createText({textContent:s.doc.data().message}),e.createSmall({textContent:`${s.doc.data().user} | ${s.doc.data().time} `})]})))),n.scrollTop=n.scrollHeight})})}changeDate(){return new Date().toLocaleString("be-NL")}}class ke extends g{constructor(){super({name:"chatlist",routerPath:"/chatlist"});this.user=new N,this.chatroom=new F}async renderAsync(){return this.clearComponentContainer(),this.chatroom.getEventChatrooms(),this.chatroom.getFriendsChatrooms(),this.componentContainer.appendChild(e.createContainer({className:"image-background",id:"image-background2"})),this.componentContainer.appendChild(e.createHeaderNav({containerClassName:"header-nav-container",title:"WH<span>!</span>STLE CHAT",subTitle:"Stay connected with friends!"})),this.componentContainer.appendChild(e.createContainer({className:"chatroom-container",children:[e.createHeader({size:5,textContent:"My Chat List."}),e.createHorizontalRule({size:2}),e.createContainer({className:"chat-container",children:[e.createLabel({textContent:"Friend Chat",className:"event-chat-container__label"})]}),e.createContainer({className:"event-chat-container",children:[e.createLabel({textContent:"Event Chat",className:"event-chat-container__label"})]})]})),this.componentContainer}}class De extends g{constructor(){super({name:"chatroom",routerPath:"/chatroom"});this.user=new N,this.chatroom=new F,this.event=new E}async renderAsync(){return this.clearComponentContainer(),await this.event.getSpecificEvent(localStorage.getItem("chatroomID")),await this.chatroom.getMessages(),this.componentContainer.appendChild(e.createContainer({className:"image-background",id:"image-background2"})),this.componentContainer.appendChild(e.createHeaderNav({containerClassName:"header-nav-container",title:"WH<span>!</span>STLE CHAT",subTitle:"Stay connected with friends!"})),this.componentContainer.appendChild(e.createContainer({className:"chat",children:[e.createContainer({className:"chat__field",children:[e.createContainer({className:"chat__title-container",children:[e.createUserAvatar({radius:"45px",className:"chat__avatar",url:"../assets/other/cityscape.svg"}),e.createHeader({size:5,textContent:this.event.name,className:"chat__title"})]}),e.createHorizontalRule({size:2})]}),e.createContainer({className:"chat__input",children:[e.createInput({placeholder:"Please insert your message...",type:"text",id:"chatInput"}),e.createButton({textContent:'<i class="fas fa-paper-plane fa-lg"></i>',onClick:()=>{this.chatroom.sendMessage()}})]})]})),this.componentContainer}}class Ae extends g{constructor(){super({name:"chatroom-friend",routerPath:"/chatroom-friend"});this.user=new N,this.chatroom=new F}async renderAsync(){return this.clearComponentContainer(),this.chatroom.getMessages(),this.componentContainer.appendChild(e.createContainer({className:"image-background",id:"image-background2"})),this.componentContainer.appendChild(e.createHeaderNav({containerClassName:"header-nav-container",title:"WH<span>!</span>STLE FRIENDS",subTitle:"Stay connected with friends!"})),this.componentContainer.appendChild(e.createContainer({className:"chat",children:[e.createContainer({className:"chat__field",children:[e.createContainer({className:"chat__title-container",children:[e.createUserAvatar({radius:"45px",className:"chat__avatar",url:JSON.parse(localStorage.getItem("friend")).avatarImageUrl}),e.createHeader({size:5,textContent:`Chat with ${JSON.parse(localStorage.getItem("friend")).username}`,className:"chat__title"})]}),e.createHorizontalRule({size:2})]}),e.createContainer({className:"chat__input",children:[e.createInput({placeholder:"Please insert your message...",type:"text",id:"chatInput"}),e.createButton({textContent:'<i class="fas fa-paper-plane fa-lg"></i>',onClick:()=>{this.chatroom.sendMessage()}})]})]})),this.componentContainer}}class Le extends g{constructor(){super({name:"take-care-mode",routerPath:"/take-care-mode"});this.event=new E,this.location=new x,this.panic=new R}async renderAsync(){this.clearComponentContainer(),await this.event.getSpecificEvent(localStorage.getItem("activeEventUID")),await this.location.updatePositionUsers(),await this.location.listenForPositionChanges(),await this.location.getUsersCoords(),await this.panic.listenForPanics(this.componentContainer),this.componentContainer.appendChild(e.createContainer({className:"image-background",id:"image-background2"})),this.componentContainer.appendChild(e.createHeaderNav({containerClassName:"header-nav-container",title:"TAKE CARE MODE"})),this.componentContainer.appendChild(e.createText({textContent:`${this.event.name} is now happening!<br>Please take care while travelling to your location!`,className:"take-care-mode-container__title"})),this.componentContainer.appendChild(e.createContainer({className:"take-care-map",children:[e.createTakeCareMap({eventCoords:this.event.location.coords,coords:localStorage.getItem("currentPositionCoords").split(","),zoom:12.5,usersInfo:this.location.takeCareUserInfo})]})),this.componentContainer.appendChild(e.createButton({textContent:'WHISTLE <i class="fas fa-exclamation-circle"></i>',className:"button__panic take-care-mode-container__whistle",onClick:()=>{c(".button__panic").className==="button__panic take-care-mode-container__whistle"?(c(".button__panic").className="button__panic take-care-mode-container__whistle--active",this.panic.sendAlert()):(c(".button__panic").className="button__panic take-care-mode-container__whistle",this.panic.removeAlert())}})),this.componentContainer.appendChild(e.createButton({textContent:"Go to Chatroom of Event",className:"button__normal take-care-mode-container__chatroom",onClick:()=>{localStorage.setItem("chatroomID",localStorage.getItem("activeEventUID")),d.navigate("/chatroom")}}));const t=setInterval(async()=>{await this.location.checkIfInEventRadius(this.event.location.coords,t).then(()=>{window.location.toString().includes("take-care-mode")||clearInterval(t)});const a=c(".take-care-map");a.innerHTML="",await this.location.getUsersCoords(),a.appendChild(e.createTakeCareMap({eventCoords:this.event.location.coords,coords:localStorage.getItem("currentPositionCoords").split(","),zoom:12.5,usersInfo:this.location.takeCareUserInfo}))},2e4);return this.componentContainer}}class He extends g{constructor(){super({name:"edit-event",routerPath:"/edit-event"});this.host=new M,this.location=new x,this.firestore=w(),this.event=new E}async renderAsync(){this.clearComponentContainer(),await this.event.getSpecificEvent(localStorage.getItem("hostedEventUID")),this.componentContainer.appendChild(e.createContainer({className:"image-background",id:"image-background2"}));const t=document.createElement("form");t.className="create__form";const a=document.createElement("div");a.className="form",this.componentContainer.appendChild(e.createHeaderNav({containerClassName:"header-nav-container",title:"WH<span>!</span>STLE EDIT",subTitle:"Edit your own event!"})),this.componentContainer.appendChild(e.createContainer({className:"create__text",children:[e.createHeader({size:3,textContent:"Edit."}),e.createText({textContent:"Edit your event."})]})),a.appendChild(e.createContainer({children:[e.createInput({className:"form__input",type:"text",id:"eventTitle",required:!0,value:this.event.name}),e.createLabel({textContent:"<span class='form__label-name'>Event Title</span>",className:"form__label"})]}));const n=document.createElement("textarea");n.name="description",n.maxLength=200,n.value=this.event.description,a.appendChild(e.createContainer({className:"form__textarea",children:[e.createLabel({textContent:"Description",className:"form__account-label"}),n]})),a.appendChild(e.createContainer({children:[e.createInput({className:"form__input",type:"date",id:"eventDate",required:!0,value:this.event.date}),e.createLabel({textContent:"Event Date",className:"form__label"})]})),a.appendChild(e.createContainer({children:[e.createInput({className:"form__input",type:"time",id:"startTime",required:!0,value:this.event.startTime}),e.createLabel({textContent:"Start of Event",className:"form__label"})]})),a.appendChild(e.createContainer({children:[e.createInput({className:"form__input",type:"time",id:"endTime",required:!0,value:this.event.endTime}),e.createLabel({textContent:"End of Event",className:"form__label"})]}));const s=document.createElement("form");return s.className="avatar-overlay__input",s.appendChild(e.createButton({textContent:"Upload Image...",className:"button__normal avatar-overlay__button"})),s.appendChild(e.createInput({type:"file",className:"avatar-overlay__file",name:"avatarImage",id:"avatarImage"})),a.appendChild(e.createContainer({className:"form__input",children:[e.createLabel({textContent:"Event Banner",className:"form__account-label"}),s]})),a.appendChild(e.createButton({textContent:"Update Event",className:"button__invite create-button",onClick:async()=>{await this.host.editEvent(localStorage.getItem("hostedEventUID")).then(()=>{d.navigate("/my-hosted-event")})}})),t.appendChild(a),this.componentContainer.appendChild(t),this.componentContainer}}const Y=()=>{const i=document.querySelector("#app"),t=document.querySelector("#portal"),a=new Ce(i,t);a.addComponent(new ve),a.addComponent(new ge),a.addComponent(new fe),a.addComponent(new _e),a.addComponent(new ye),a.addComponent(new Ne),a.addComponent(new xe),a.addComponent(new we),a.addComponent(new Ee),a.addComponent(new Ie),a.addComponent(new Se),a.addComponent(new Te),a.addComponent(new Ue),a.addComponent(new ke),a.addComponent(new De),a.addComponent(new Ae),a.addComponent(new Le),a.addComponent(new He)},Me=()=>{if(localStorage.getItem("animationLoaded"))Y();else{const i=c("#app"),t=e.createStartupAnimation(),a=document.createElement("div");a.id="image-background",i.appendChild(a),i.appendChild(t),setTimeout(()=>{Y()},5e3),localStorage.setItem("animationLoaded",!0)}"serviceWorker"in navigator&&navigator.serviceWorker.register("./sw.js")};window.addEventListener("load",Me);
